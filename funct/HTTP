import requests
from flask import Flask, request

app = Flask(__name__)

def trigger_deploy():
    options = {
        "method": "POST",
        "url": "https://api.netlify.com/build_hooks/xxxxxxxxxxxx3b15ad",
        "headers": {
            "Content-type": "application/json",
        }
    }
    response = requests.request(**options)
    print(response.status_code)

def has_word(string, word):
    return word in string.split()

@app.route('/', methods=['POST'])
def handle_request():
    body = request.json['event']['text']
    should_trigger = has_word(body, "deploy")
    
    if should_trigger:
        trigger_deploy()
    
    return '', 200

if __name__ == '__main__':
    app.run()
